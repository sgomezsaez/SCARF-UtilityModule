<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Kereta API</title>
<style>
body { font-family: "Courier New", Courier, monospace; max-width: 900px; }
td, th { padding-right: 1em; text-align: left; }
textarea { height: 12em; width: 20em; display: block; }
</style>
</head>

<body>

<h1>Kereta API</h1>
<p>
<ul>
<li><a href="#Quickstart">0. Quickstart</a></li>
<li><a href="#Installation">1. Installation</a></li>
<li><a href="#Get">2. Get Resources</a></li>
<li><a href="#Create">3. Create Resources</a></li>
<li><a href="#Update">4. Update Resources</a></li>
<li><a href="#Delete">5. Delete Resources</a></li>
<li><a href="#Functionality">6. Functionality</a></li>
<li><a href="#Licence">7. Licence</a></li>
</ul>
</p>

<a name="Quickstart"></a>
<h2>0. Quickstart</h2>
<p>
<table>
<tr><th>Verb</th><th>Description</th></tr>
<tr><td>GET</td><td>Get (a) Resource(s)</td></tr>
<tr><td>PUT</td><td>Update a Resource</td></tr>
<tr><td>POST</td><td>Create a Resource</td></tr>
<tr><td>DELETE</td><td>Delete a Resource</td></tr>
</table>
</p>
<p>
<table>
<tr><th>Resource-URI</th><th>Verbs</th><th>Representation</th></tr>
<tr><td>/</td><td>GET</td><td>HTML</td></tr>
<tr><td>/Installation</td><td>GET,POST</td><td>HTML</td></tr>
<tr><td>----</td><td>---</td><td>---</td></tr>

<tr><td>/Function</td><td>GET,POST</td><td>XML</td></tr>
<tr><td>/Function/{fct-id}</td><td>GET,PUT,DELETE</td><td>XML</td></tr>
<tr><td>/Function/{fct-id}/Parameter</td><td>GET</td><td>XML</td></tr>
<tr><td>/Function/{fct-id}/Parameter/{parm-name}</td><td>GET,PUT,POST,DELETE</td><td>XML</td></tr>
<tr><td>----</td><td>---</td><td>---</td></tr>

<tr><td>/Application</td><td>GET,POST</td><td>XML</td></tr>
<tr><td>/Application/{app-id}</td><td>GET,PUT,DELETE</td><td>XML</td></tr>
<tr><td>/Application/{app-id}/Tier</td><td>GET</td><td>XML</td></tr>
<tr><td>/Application/{app-id}/Tier/{tier-nbr}</td><td>GET,PUT,POST,DELETE</td><td>XML</td></tr>
<tr><td>/Application/{app-id}/Distribution</td><td>GET,POST</td><td>XML</td></tr>
<tr><td>/Application/{app-id}/Requirement</td><td>GET</td><td>XML</td></tr>
<tr><td>/Application/{app-id}/Requirement/{req-name}</td><td>GET,PUT,POST,DELETE</td><td>XML</td></tr>
<tr><td>----</td><td>---</td><td>---</td></tr>
<tr><td>/Distribution</td><td>GET,POST</td><td>XML</td></tr>
<tr><td>/Distribution/{dstr-id}</td><td>GET,PUT,DELETE</td><td>XML</td></tr>
<tr><td>/Distribution/{dstr-id}/UtilityFunction</td><td>GET,POST</td><td>XML</td></tr>
<tr><td>/Distribution/{dstr-id}/Offering</td><td>GET</td><td>XML</td></tr>
<tr><td>/Distribution/{dstr-id}/Offering/{of-nbr}</td><td>GET,POST,PUT,DELETE</td><td>XML</td></tr>
<tr><td>/Distribution/{dstr-id}/Offering/{of-nbr}/Performance</td><td>GET</td><td>XML</td></tr>
<tr><td>/Distribution/{dstr-id}/Offering/{of-nbr}/Performance/{prf-name}</td><td>GET,PUT,POST,DELETE</td><td>XML</td></tr>
<tr><td>----</td><td>---</td><td>---</td></tr>
<tr><td>/UtilityFunction</td><td>GET,POST</td><td>XML</td></tr>
<tr><td>/UtilityFunction/{uf-id}</td><td>GET,PUT,DELETE</td><td>XML</td></tr>
<tr><td>/UtilityFunction/{uf-id}/SubFunction</td><td>GET</td><td>XML</td></tr>
<tr><td>/UtilityFunction/{uf-id}/SubFunction/{sf-nbr}</td><td>GET,PUT,POST,DELETE</td><td>XML</td></tr>
<tr><td>/UtilityFunction/{uf-id}/SubFunction/{sf-nbr}/NefologParameter</td><td>GET</td><td>XML</td></tr>
<tr><td>----</td><td>---</td><td>---</td></tr>
<tr><td>/Type</td><td>GET</td><td>XML</td></tr>
<tr><td>/Type/ApplicationType</td><td>GET</td><td>XML</td></tr>
<tr><td>/Type/ApplicationType/{type-name}</td><td>GET,POST,DELETE</td><td>XML</td></tr>
<tr><td>/Type/RequirementType</td><td>GET</td><td>XML</td></tr>
<tr><td>/Type/FunctionType</td><td>GET</td><td>XML</td></tr>
<tr><td>/Type/FunctionType/{type-name}</td><td>GET,POST,DELETE</td><td>XML</td></tr>
<tr><td>/Type/DataType</td><td>GET</td><td>XML</td></tr>
<tr><td>/Type/DataType/{type-name}</td><td>GET,POST,DELETE</td><td>XML</td></tr>
<tr><td>----</td><td>---</td><td>---</td></tr>
<tr><td>/Function/{fct-id}/calc?[assignment]</td><td>GET</td><td>XML</td></tr>
<tr><td>/UtilityFunction/{uf-id}/calc?key=[key]</td><td>GET</td><td>XML</td></tr>
<tr><td>/UtilityFunction/{uf-id}/SubFunction/{sf-nbr}/assign?key=[key]&amp;[assignment]</td><td>GET</td><td>XML</td></tr>
<tr><td>/UtilityFunction/{uf-id}/SubFunction/{sf-nbr}/calc?key=[key]</td><td>GET</td><td>XML</td></tr>
<tr><td>/Application/{app-id}/select?[query]</td><td>GET</td><td>XML</td></tr>
<tr><td>/Application/{app-id}/compare?[query]</td><td>GET</td><td>XML</td></tr>
<tr><td>/Distribution/{dstr-id}/check</td><td>GET</td><td>XML</td></tr>
<tr><td>/Search?[query]</td><td>GET</td><td>XML</td></tr>
<tr><td>/UtilityFunction/{uf-id}/clone?distribution=[dstr-id]</td><td>GET</td><td>XML</td></tr>
</table>
</p>

<a name="Installation"></a>
<h2>1. Installation</h2>

<h3>1.1 Deployment</h3>
</p>
Deploy the 'kereta.war' file or use the project to create your own war-file. 
Assumed root path is "/Kereta"
</p>
<h3>1.2 Database</h3>
<p>
Creata a empty database (recommended: character set=utf8; collation order=utf8_bin) 
or reuse a existing database with existing tables and already existing content.
Database user requires at least SELECT, INSERT, UPDATE AND DELETE permissions.
</p>
<h3>1.3 Configuration</h3>
<p>
Use a browser and go to: <a href="Installation">/Kereta/Installation</a>.<br>
Insert Kereta and Nefolog root.<br>
Insert database user and password.<br>
If you start with an empty database, only select "Create Tables".<br>
If you start with existing tables you want to ERASE, select "Drop Existing Tables" and "Create Tables".<br>
If you start with existing tables you want to use, select nothing.<br>
If you want to create the resources from the related diploma thesis (additionally) select "Inital Resources".<br>
When choosing "Drop Existing Tables", the database user requires DROP permission.<br>
Press "Submit".<br>
Kereta stores the database URL and login details.<br>
Kereta tries to connect the database.<br>
Optional: drop existing tables<br>
Optional: create tables and insert mandatory resources (function-, requirement- and data-types).<br>
Optional: drop existing tables.<br>
Kereta is ready to use.<br>
</p>

<a name="Get"></a>
<h2>2. Get Resources</h2>

Each URI from <a href="#Quickstart">Section 0</a> can be used with the GET-Method. The first two returns a HTML representation, the last 8 URIs are explained in <a href="#Functionality">Section 6</a>.
The method acts in a uniform manner for the remaining URIs. Kereta always returns the resource's XML representation to the client.</br>
If the URI identifies a single resource (e.g. /Function/{fct-id}), Kereta returns a XML document which document element is named after the resource type (first letter lower case).
If the URI identifies a set of 0..n resources (e.g. /Function), Kereta returns a XML document which document element is named after the resource type in plural (first letter lower case) and contains all identified resources like mentioned before.


<a name="Create"></a>
<h2>3. Create Resources</h2>
<p>
Assumed root path is "/Kereta"<br>
POST methods only create initial resources and do not process input.<br>
Kereta always returns the created resource's XML representation to the client.<br> 
3.1, 3.2, 3.3 and 3.4 assign identifiers automatically. The identifier can be picked from the returned representation.
</p>

<h3>3.1 Function Resource</h3>
POST: /Kereta/Function

<h4>3.1.1 Parameter Resource</h4>
POST: /Kereta/Function/{function-id}/Parameter/{parameter-name}

<h3>3.2 Application Resource</h3>
POST: /Kereta/Application

<h4>3.2.1 (Application) Requirement Resource</h4>
POST: /Kereta/Application/{application-id}/Requirement/{requirement-name}

<h4>3.2.2 Tier Resource</h4>
POST: /Kereta/Application/{application-id}/Tier/{tier-identifier}
tier-identifier must be a number > 0.

<h5>3.2.2.1 (Tier) Requirement Resource</h5>
POST: /Kereta/Application/{application-id}/Tier/{tier-identifier}/Requirement/{requirement-name}

<h4>3.2.3 Distribtion Resource</h4>
POST: /Kereta/Application/{application-id}/Distribution
Not the only way to create a distribution resource. This way creates a resource that is already linked to the application resource.


<h3>3.3 Distribution Resource</h3>
POST: /Kereta/Distribution

<h4>3.3.1 Offering Resource</h4>
POST: /Kereta/Distribution/{distribution-id}/Offering/{offering-identifier}
offering-identifier must be a number >= 0.

<h4>3.3.2 Performance Resource</h4>
POST: /Kereta/Distribution/{distribution-id}/Offering/{offering-identifier}/Performance/{performance-name}


<h3>3.4 Utility Function Resource</h3>
POST: /Kereta/UtilityFunction

<h4>3.4.1 Utility Function Subfunction Resource</h4>
POST: /Kereta/UtilityFunction/{utility-function-id}/SubFunction/{subfunction-identifier}
subfunction-identifier must be a number >= 0.


<h3>3.5 Application Type Resource</h3>
POST: /Kereta/Type/ApplicationType/{type-name}


<h3>3.6 Function Type Resource</h3>
POST: /Kereta/Type/FunctionType/{type-name}


<h3>3.7 Data Type Resource</h3>
POST: /Kereta/Type/DataType/{type-name}<br>
DataType has to be replaced, either by ApplicationType, FunctionType or DataType.

<a name="Update"></a>
<h2>4. Update Resources</h2>
<p>
Assumed root path is "/Kereta"<br>
PUT methods requires a XML-document that which document element has the correct tag-name and contains a element for all properties that should be updated. Properties that effected the resource's URI can't be updated.<br>
Kereta always returns the updated resource's XML representation to the client. <br>
</p>

<h3>4.1 Function Resource</h3>
PUT: /Kereta/Function/{function-id}<br>
<textarea>
<function>
  <alias/>
  <formula/>
  <description/>
  <functionType/>
  <author/>
</function>
</textarea>
The tag-name "function" is mandatory. Nested elements are only necessary when the related property has to be changed.

<h4>4.1.1 Parameter Resource</h4>
PUT: /Kereta/Function/{function-id}/Parameter/{parameter-name}<br>
<textarea>
<parameter>
  <dataType/>
  <defaultValue/>
  <description/>
  <author/>
</parameter>
</textarea>
The tag-name "parameter" is mandatory. Nested elements are only necessary when the related property has to be changed.

<h3>4.2 Application Resource</h3>
PUT: /Kereta/Application/{application-id}<br>
<textarea>
<application>
  <alias/>
  <applicationType/>
  <name/>
  <description/>
  <author/>
</application>
</textarea>
The tag-name "application" is mandatory. Nested elements are only necessary when the related property has to be changed.

<h4>4.2.1 (Application) Requirement Resource</h4>
PUT: /Kereta/Application/{application-id}/Requirement/{requirement-name}<br>
<textarea>
<requirement>
  <value/>
  <demand/>
  <dataType/>
  <requirementType/>
  <author/>
</requirement>
</textarea>
The tag-name "requirement" is mandatory. Nested elements are only necessary when the related property has to be changed.

<h4>4.2.2 Tier Resource</h4>
PUT: /Kereta/Application/{application-id}/Tier/{tier-identifier}<br>
<textarea>
<tier>
  <name/>
  <description/>
  <author/>
</tier>
</textarea>
The tag-name "tier" is mandatory. Nested elements are only necessary when the related property has to be changed.

<h5>4.2.2.1 (Tier) Requirement Resource</h5>
PUT: /Kereta/Application/{application-id}/Tier/{tier-identifier}/Requirement/{requirement-name}<br>
<textarea>
<requirement>
  <value/>
  <demand/>
  <dataType/>
  <requirementType/>
  <author/>
</requirement>
</textarea>
The tag-name "requirement" is mandatory. Nested elements are only necessary when the related property has to be changed.


<h3>4.3 Distribution Resource</h3>
PUT: /Kereta/Distribution/{distribution-id}<br>
<textarea>
<distribution>
  <representation/>
  <language/>
  <languageVersion/>
  <author/>
</distribution>
</textarea>
The tag-name "distribution" is mandatory. Nested elements are only necessary when the related property has to be changed.

<h4>4.3.1 Offering Resource</h4>
PUT: /Kereta/Distribution/{distribution-id}/Offering/{offering-identifier}<br>
<textarea>
<offering>
  <nefologConfiguration/>
  <nefologConfigurationId/>
  <nefologOfferingName/>
  <nefologServiceType/>
  <nefologProvider/>
  <author/>
</offering>
</textarea>
The tag-name "offering" is mandatory. Nested elements are only necessary when the related property has to be changed.

<h4>4.3.2 Performance Resource</h4>
POST: /Kereta/Distribution/{distribution-id}/Offering/{offering-identifier}/Performance/{performance-name}<br>
<textarea>
<performance>
  <value/>
  <demand/>
  <dataType/>
  <requirementType/>
  <author/>
</performance>
</textarea>
The tag-name "performance" is mandatory. Nested elements are only necessary when the related property has to be changed.

<h3>4.4 Utility Function Resource</h3>
PUT: /Kereta/UtilityFunction/{utility-function-id}<br>
<textarea>
<utilityFunction>
  <alias/>
  <description/>
  <author/>
</utilityFunction>
</textarea>
The tag-name "utilityFunction" is mandatory. Nested elements are only necessary when the related property has to be changed.

<h4>4.4.1 Utility Function Subfunction Resource</h4>
PUT: /Kereta/UtilityFunction/{utility-function-id}/SubFunction/{subfunction-identifier}<br>
<textarea>
<subFunction>
  <functionId/>
  <author/>
</subFunction>
</textarea>
The tag-name "subFunction" is mandatory. Nested elements are only necessary when the related property has to be changed.

<a name="Delete"></a>
<h2>5. Delete Resources</h2>
<a href="#Quickstart">Section 0</a> contains the information about which URIs provide the DELETE method.
Basically, DELETE is only provided for URIs that identifies a single resource (e.g. /Function/{fct-id}). Calling the method deletes the resource from the repository and returns only a status code (success: 204 or the respective error code).

<a name="Functionality"></a>
<h2>6. Functionality</h2>
Some URIs' GET methods provide functionalies which go beyond the management of resources.

<h3>6.1 Calculate Function</h3>
<p>
<b>Function/{fct-id}/calc?[assignment]</b><br>
The URL query [assignment] contains the parameters occuring in the identified function and related parameter assignments.
Each pair of parameter name and assigned value builds a query parameter. E.g. a function contains parameters a and b, then 
[assignment] should be replaced by a={assigned-value-for-a}&amp;b={assigned-value-for-b}.</p>
<p>
Kereta accepts numbers, string, array of numbers, array of strings and multi-dimensional arrays of numbers or strings.<br>
The syntax of strings and numbers is straightforward (e.g. a, 1, 1.9999). Arrays are denoted by [ ] and commas seperate elements
(e.g. [1, 2, 1.7] [[1, 4.1] [2.222, -1]]).
</p>
<p>
The returned XML document's root element's name is calculation. Its first child is named result and contains the result of the calculation. More elements shows the formula in different representations and parameters.
</p>

<h3>6.2 Calculate Utility Function</h3>

<p>
<b>GET: /UtilityFunction/{uf-id}/SubFunction/{sf-nbr}/assign?key=[key]&amp;[assignment]</b><br>
First, users have to assign values to occuring parameters for each utility function subfunction of the identified utility function.<br>
The [assignment]-part is build exactly like before (6.1 Calculate Function). The additional key parameter identifies the assignment for the subfunction.
All assignments to the subfunctions must be performed with the same key. But it is possible to store different assignments under different keys. 
This allows for the calculation of the utility function with respect to different scenarios.<br>
The method returns a XML document with a single element key. This element contains the defined key.</p>

<p>
<b>GET: /UtilityFunction/{uf-id}/SubFunction/{sf-nbr}/calc?key=[key]</b><br>
This method requires a already performed assignment. It is sufficient to name the assignment's key to get the result of the calculation.<br>
The returned XML document is nearly equal to the one in 6.1 (Calculate Function). The root element contains additional attributes.
These attributes are: class, number and type. class="subfunction", number provides the identifier of the subfunction within the superior utility function and
type provides the function type of the linked function resource.
</p>

<p>
<b>GET: /UtilityFunction/{uf-id}/calc?key=[key]</b><br>
This method requires already performed assignments for each subfunction, performes the calculation for each subfunction and determines the result of the utility function. <br>
The root element is called calculation and contains attribute class="utilityFunctions". The first child element is called result and provides the result of the calculation. More child elements provide the distribution's id and the conclussion of the subfunction calculation.
</p>

<h3>6.3 Decision Support</h3>

<p>
<b>GET: /Application/{app-id}/select?[query]</b><br>
A set of distribution resources is related to the identified application resource. This method allows for the selection of the distribution with the highest expected utility.<br>
The method requires a existing utility function for each suggested distribution, the parameter assignment for each utility function subfunction and the user's knowledge about the aliases of these resources.<br>
The query string must contain a entry for every suggested distribution. These entries consist of the distributions id (or alias), the utility functions id (or alias) and the key of the parameter assignment.
The entries' syntax is: {dstr-id-or-alias}={uf-id-or-alias}:{key}<br>
The method returns a XML document with root element selection. This element contains the XML-tree known from /UtilityFunction/{uf-id}/calc?key=[key] for the distribution which promises the highest utility.
</p>

<p>
<b>GET: /Application/{app-id}/compare?[query]</b><br>
The query string is build exactly like before. The difference is, that the root element's name is listing and it contains the XML-trees known from /UtilityFunction/{uf-id}/calc?key=[key] for each suggested distribution.
</p>

<p>
<b>GET: /Distribution/{dstr-id}/check</b><br>
This method returns a listing of the requirements of the identified distribution's related application and tiers. The performance resources nested within the distribution's offerings, are matched to these requirements.
</p>

<h3>6.4 Decision Support</h3>

<p>
<b>GET: /Search?query</b><br>
Query parameters can be resource, applicationType and functionType.<br>
Possible values for parameter resource are Application, UtilityFunction or Function.<br>
Possible values for parameter applicationType can be any application type (see /Type/ApplicationType).<br>
Possible values for parameter functionType can be any revenue, cost, misc or any customized function type (see /Type/FunctionType).<br>
The method returns a XML document with root element selection which contains every resource's representation that matches the query.
</p>

<p>
<b>GET: /UtilityFunction/{uf-id}/clone?distribution=[dstr-id]</b><br>
The URI identifies a utility function and the string query identifies a distribution. The method clones the utility function and nested utility function subfunctions for the distribution.<br>
The method returns the created distribution's XML representation.
</p>

<a name="Licence"></a>
<h2>7. Licence</h2>
<p>
Copyright [2016] [Florian Hannes Frech]
</p>
<p>
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at
</p>
&nbsp;&nbsp;&nbsp; <a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a>
<p>
Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
</p>

<br><br><br><br>
<br><br><br><br>
<br><br><br><br>



</body>

</html> 



























